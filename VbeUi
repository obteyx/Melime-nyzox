local VbeUi = {}
VbeUi.__index = VbeUi

function VbeUi.new()
    local self = setmetatable({}, VbeUi)

    local player = game.Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "VbeUi"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Parent = playerGui

    local Frame = Instance.new("Frame")
    Frame.Name = "MainFrame"
    Frame.Position = UDim2.new(0.4, 0, 0.2, 0)
    Frame.Size = UDim2.new(0, 480, 0, 550)
    Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.Parent = Frame

    local Close = Instance.new("TextButton")
    Close.Name = "CloseButton"
    Close.Position = UDim2.new(0.95, 0, 0.03, 0)
    Close.Size = UDim2.new(0, 20, 0, 20)
    Close.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
    Close.BorderSizePixel = 0
    Close.Text = "X"
    Close.TextColor3 = Color3.new(1,1,1)
    Close.Font = Enum.Font.SourceSansBold
    Close.TextSize = 18
    Close.Parent = Frame

    Close.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    -- Container for tab buttons
    local TabButtonsFrame = Instance.new("Frame")
    TabButtonsFrame.Size = UDim2.new(1, 0, 0, 40)
    TabButtonsFrame.Position = UDim2.new(0, 0, 0, 50)
    TabButtonsFrame.BackgroundTransparency = 1
    TabButtonsFrame.Parent = Frame

    local TabsContentFrame = Instance.new("Frame")
    TabsContentFrame.Size = UDim2.new(1, 0, 1, -100)
    TabsContentFrame.Position = UDim2.new(0, 0, 0, 100)
    TabsContentFrame.BackgroundTransparency = 1
    TabsContentFrame.Parent = Frame

    local tabNames = {"Tab 1", "Tab 2", "Tab 3"}
    local tabButtons = {}
    local tabFrames = {}

    local function createTabContent(name)
        local content = Instance.new("Frame")
        content.Name = name .. "_Content"
        content.Size = UDim2.new(1, 0, 1, 0)
        content.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        content.BorderSizePixel = 0
        content.Visible = false
        content.Parent = TabsContentFrame
        return content
    end

    for i, name in ipairs(tabNames) do
        -- Create tab button
        local tabBtn = Instance.new("TextButton")
        tabBtn.Name = name .. "_TabButton"
        tabBtn.Size = UDim2.new(0, 140, 1, 0)
        tabBtn.Position = UDim2.new(0, (i-1)*150, 0, 0)
        tabBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        tabBtn.BorderSizePixel = 0
        tabBtn.Text = name
        tabBtn.TextColor3 = Color3.new(1,1,1)
        tabBtn.Font = Enum.Font.SourceSansBold
        tabBtn.TextSize = 16
        tabBtn.Parent = TabButtonsFrame

        table.insert(tabButtons, tabBtn)

        -- Create content frame
        local contentFrame = createTabContent(name)
        table.insert(tabFrames, contentFrame)
    end

    -- Active tab tracking
    local activeTabIndex = 1
    tabFrames[activeTabIndex].Visible = true
    tabButtons[activeTabIndex].BackgroundColor3 = Color3.fromRGB(90, 90, 255)

    local function switchTab(index)
        if index == activeTabIndex then return end
        -- Hide old tab content and reset button color
        tabFrames[activeTabIndex].Visible = false
        tabButtons[activeTabIndex].BackgroundColor3 = Color3.fromRGB(50, 50, 50)

        -- Show new tab content and highlight button
        tabFrames[index].Visible = true
        tabButtons[index].BackgroundColor3 = Color3.fromRGB(90, 90, 255)

        activeTabIndex = index
    end

    for i, btn in ipairs(tabButtons) do
        btn.MouseButton1Click:Connect(function()
            switchTab(i)
        end)
    end

    self.ScreenGui = ScreenGui
    self.Frame = Frame
    self.Tabs = tabFrames
    self.TabButtons = tabButtons
    self.SwitchTab = switchTab

    return self
end

return VbeUi

